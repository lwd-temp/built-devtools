{"version":3,"file":"DetailsView.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/timeline/components/DetailsView.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,IAAI,MAAM,4BAA4B,CAAC;AACnD,OAAO,KAAK,WAAW,MAAM,gCAAgC,CAAC;AAC9D,OAAO,KAAK,EAAE,MAAM,8BAA8B,CAAC;AAEnD,wEAAwE;AACxE,sEAAsE;AACtE,uEAAuE;AACvE,iEAAiE;AACjE,wEAAwE;AAExE,MAAM,SAAS,GAAG;IAChB;;;OAGG;IACH,YAAY,EAAE,eAAe;IAC7B;;;OAGG;IACH,+BAA+B,EAAE,2CAA2C;IAC5E;;;;OAIG;IACH,6BAA6B,EAAE,2DAA2D;IAC1F;;;;OAIG;IACH,MAAM,EAAE,mBAAmB;IAC3B;;;OAGG;IACH,QAAQ,EAAE,WAAW;CACtB,CAAC;AAEF,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,2CAA2C,EAAE,SAAS,CAAC,CAAC;AACjG,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;AAEtE,MAAM,UAAU,4BAA4B,CACxC,KAAmD,EACnD,eAAgE;IAClE,MAAM,QAAQ,GAAG,eAAe,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;IAC9D,MAAM,eAAe,GAAsB,EAAE,CAAC;IAC9C,IAAI,CAAC,QAAQ,EAAE;QACb,OAAO,eAAe,CAAC;KACxB;IACD,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE;QAC9B,MAAM,QAAQ,GACV,WAAW,CAAC,OAAO,CAAC,MAAM,CAAC,0BAA0B,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;QACjH,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC5C,QAAQ,OAAO,EAAE;YACf,KAAK,cAAc,CAAC;YACpB,KAAK,eAAe,CAAC,CAAC;gBACpB,MAAM,gBAAgB,GAAG,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAC1C,wJAAwJ,EACxJ,UAAU,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;gBACxC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,wBAAwB,CAC/C,IAAI,EAAE,SAAS,CAAC,+BAA+B,EAAE,EAAC,GAAG,EAAE,gBAAgB,EAAC,CAAC,CAAC,CAAC;gBAC/E,MAAM;aACP;YACD,KAAK,yBAAyB,CAAC,CAAC;gBAC9B,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,WAAW,CAAC,4BAA4B,CAAC,KAAK,CAAC,EAAE;oBACtE,MAAM;iBACP;gBACD,MAAM,UAAU,GACZ,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC,QAAQ,IAAI,CAAC,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,sBAAsB,CAAC,EAAE,IAAI,CAAC,CAAC;gBACvG,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC,SAAS,CAAC,6BAA6B,EAAE,EAAC,GAAG,EAAE,UAAU,EAAC,CAAC,CAAC;gBAC1F,MAAM;aACP;YAED,KAAK,WAAW,CAAC,CAAC;gBAChB,MAAM,YAAY,GACd,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,sCAAsC,EAAE,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAClG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,wBAAwB,CAC/C,IAAI,EAAE,SAAS,CAAC,MAAM,EACtB,EAAC,GAAG,EAAE,YAAY,EAAE,GAAG,EAAE,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC,QAAQ,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,EAAC,CAAC,CAAC,CAAC;gBACzF,MAAM;aACP;YACD,OAAO,CAAC,CAAC;gBACP,SAAS;aACV;SACF;QACD,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC5B;IACD,OAAO,eAAe,CAAC;AACzB,CAAC","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as TraceEngine from '../../../models/trace/trace.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\n\n// *********************************************************************\n// At the moment this file consists of helpers to aid in the rendering\n// of events details in the bottom drawer. In the future, we should use\n// LitHtml for this section, and update this helpers accordingly.\n// *********************************************************************\n\nconst UIStrings = {\n  /**\n   *@description Text in the Performance panel for a forced style and layout calculation of elements\n   * in a page. See https://developer.mozilla.org/en-US/docs/Glossary/Reflow\n   */\n  forcedReflow: 'Forced reflow',\n  /**\n   *@description Text in Timeline UIUtils of the Performance panel\n   *@example {Forced reflow} PH1\n   */\n  sIsALikelyPerformanceBottleneck: '{PH1} is a likely performance bottleneck.',\n  /**\n   *@description Text in the Performance panel for a function called during a time the browser was\n   * idle (inactive), which to longer to execute than a predefined deadline.\n   *@example {10ms} PH1\n   */\n  idleCallbackExecutionExtended: 'Idle callback execution extended beyond deadline by {PH1}',\n  /**\n   *@description Text in the Performance panel which describes how long a task took.\n   *@example {task} PH1\n   *@example {10ms} PH2\n   */\n  sTookS: '{PH1} took {PH2}.',\n  /**\n   *@description Text in the Performance panel for a task that took long. See\n   * https://developer.mozilla.org/en-US/docs/Glossary/Long_task\n   */\n  longTask: 'Long task',\n};\n\nconst str_ = i18n.i18n.registerUIStrings('panels/timeline/components/DetailsView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport function buildWarningElementsForEvent(\n    event: TraceEngine.Types.TraceEvents.TraceEventData,\n    traceParsedData: TraceEngine.Handlers.Migration.PartialTraceData): HTMLSpanElement[] {\n  const warnings = traceParsedData.Warnings.perEvent.get(event);\n  const warningElements: HTMLSpanElement[] = [];\n  if (!warnings) {\n    return warningElements;\n  }\n  for (const warning of warnings) {\n    const duration =\n        TraceEngine.Helpers.Timing.microSecondsToMilliseconds(TraceEngine.Types.Timing.MicroSeconds(event.dur || 0));\n    const span = document.createElement('span');\n    switch (warning) {\n      case 'FORCED_STYLE':\n      case 'FORCED_LAYOUT': {\n        const forcedReflowLink = UI.XLink.XLink.create(\n            'https://developers.google.com/web/fundamentals/performance/rendering/avoid-large-complex-layouts-and-layout-thrashing#avoid-forced-synchronous-layouts',\n            i18nString(UIStrings.forcedReflow));\n        span.appendChild(i18n.i18n.getFormatLocalizedString(\n            str_, UIStrings.sIsALikelyPerformanceBottleneck, {PH1: forcedReflowLink}));\n        break;\n      }\n      case 'IDLE_CALLBACK_OVER_TIME': {\n        if (!TraceEngine.Types.TraceEvents.isTraceEventFireIdleCallback(event)) {\n          break;\n        }\n        const exceededMs =\n            i18n.TimeUtilities.millisToString((duration || 0) - event.args.data['allottedMilliseconds'], true);\n        span.textContent = i18nString(UIStrings.idleCallbackExecutionExtended, {PH1: exceededMs});\n        break;\n      }\n\n      case 'LONG_TASK': {\n        const longTaskLink =\n            UI.XLink.XLink.create('https://web.dev/optimize-long-tasks/', i18nString(UIStrings.longTask));\n        span.appendChild(i18n.i18n.getFormatLocalizedString(\n            str_, UIStrings.sTookS,\n            {PH1: longTaskLink, PH2: i18n.TimeUtilities.millisToString((duration || 0), true)}));\n        break;\n      }\n      default: {\n        continue;\n      }\n    }\n    warningElements.push(span);\n  }\n  return warningElements;\n}\n"]}