{"version":3,"file":"Breadcrumbs.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/timeline/components/Breadcrumbs.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAS7B,MAAM,UAAU,kBAAkB,CAAC,iBAA6B;IAC9D,MAAM,cAAc,GAAiB,CAAC,iBAAiB,CAAC,CAAC;IACzD,IAAI,eAAe,GAAe,iBAAiB,CAAC;IAEpD,OAAO,eAAe,CAAC,KAAK,KAAK,IAAI,EAAE;QACrC,MAAM,SAAS,GAAG,eAAe,CAAC,KAAK,CAAC;QACxC,IAAI,SAAS,KAAK,IAAI,EAAE;YACtB,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YAC/B,eAAe,GAAG,SAAS,CAAC;SAC7B;KACF;IAED,OAAO,cAAc,CAAC;AACxB,CAAC;AAED,MAAM,OAAO,WAAW;IACb,iBAAiB,CAAa;IACvC,eAAe,CAAa;IAE5B,YAAY,kBAAwD;QAClE,IAAI,CAAC,iBAAiB,GAAG;YACvB,MAAM,EAAE,kBAAkB;YAC1B,KAAK,EAAE,IAAI;SACZ,CAAC;QACF,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,iBAAiB,CAAC;IAChD,CAAC;IAED,GAAG,CAAC,wBAA8D;QAChE,IAAI,IAAI,CAAC,8BAA8B,CAAC,wBAAwB,EAAE,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE;YAC9F,MAAM,aAAa,GAAG;gBACpB,MAAM,EAAE,wBAAwB;gBAChC,KAAK,EAAE,IAAI;aACZ,CAAC;YACF,IAAI,CAAC,eAAe,CAAC,KAAK,GAAG,aAAa,CAAC;YAC3C,IAAI,CAAC,eAAe,GAAG,aAAa,CAAC;SACtC;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,6FAA6F,CAAC,CAAC;SAChH;IACH,CAAC;IAED,iHAAiH;IACjH,8BAA8B,CAC1B,KAA2C,EAAE,MAA4C;QAC3F,OAAO,CAAC,KAAK,CAAC,GAAG,IAAI,MAAM,CAAC,GAAG,IAAI,KAAK,CAAC,GAAG,IAAI,MAAM,CAAC,GAAG,CAAC;YACvD,CAAC,CAAC,KAAK,CAAC,GAAG,KAAK,MAAM,CAAC,GAAG,IAAI,KAAK,CAAC,GAAG,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC;IAC9D,CAAC;IAED,2FAA2F;IAC3F,oBAAoB,CAAC,iBAA6B;QAChD,IAAI,eAAe,GAAe,IAAI,CAAC,iBAAiB,CAAC;QAEzD,OAAO,eAAe,KAAK,iBAAiB,IAAI,eAAe,CAAC,KAAK,KAAK,IAAI,EAAE;YAC9E,eAAe,GAAG,eAAe,CAAC,KAAK,CAAC;SACzC;QAED,eAAe,CAAC,KAAK,GAAG,IAAI,CAAC;QAC7B,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC;IACzC,CAAC;CACF","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as TraceEngine from '../../../models/trace/trace.js';\n\nexport interface Breadcrumb {\n  window: TraceEngine.Types.Timing.TraceWindow;\n  child: Breadcrumb|null;\n}\n\nexport function flattenBreadcrumbs(initialBreadcrumb: Breadcrumb): Breadcrumb[] {\n  const allBreadcrumbs: Breadcrumb[] = [initialBreadcrumb];\n  let breadcrumbsIter: Breadcrumb = initialBreadcrumb;\n\n  while (breadcrumbsIter.child !== null) {\n    const iterChild = breadcrumbsIter.child;\n    if (iterChild !== null) {\n      allBreadcrumbs.push(iterChild);\n      breadcrumbsIter = iterChild;\n    }\n  }\n\n  return allBreadcrumbs;\n}\n\nexport class Breadcrumbs {\n  readonly initialBreadcrumb: Breadcrumb;\n  #lastBreadcrumb: Breadcrumb;\n\n  constructor(initialTraceWindow: TraceEngine.Types.Timing.TraceWindow) {\n    this.initialBreadcrumb = {\n      window: initialTraceWindow,\n      child: null,\n    };\n    this.#lastBreadcrumb = this.initialBreadcrumb;\n  }\n\n  add(newBreadcrumbTraceWindow: TraceEngine.Types.Timing.TraceWindow): void {\n    if (this.isTraceWindowWithinTraceWindow(newBreadcrumbTraceWindow, this.#lastBreadcrumb.window)) {\n      const newBreadcrumb = {\n        window: newBreadcrumbTraceWindow,\n        child: null,\n      };\n      this.#lastBreadcrumb.child = newBreadcrumb;\n      this.#lastBreadcrumb = newBreadcrumb;\n    } else {\n      throw new Error('Can not add a breadcrumb that is equal to or is outside of the parent breadcrumb TimeWindow');\n    }\n  }\n\n  // Breadcumb should be within the bounds of the parent and can not have both start and end be equal to the parent\n  isTraceWindowWithinTraceWindow(\n      child: TraceEngine.Types.Timing.TraceWindow, parent: TraceEngine.Types.Timing.TraceWindow): boolean {\n    return (child.min >= parent.min && child.max <= parent.max) &&\n        !(child.min === parent.min && child.max === parent.max);\n  }\n\n  // Make breadcrumb active by removing all of its children and making it the last breadcrumb\n  makeBreadcrumbActive(newLastBreadcrumb: Breadcrumb): void {\n    let breadcrumbsIter: Breadcrumb = this.initialBreadcrumb;\n\n    while (breadcrumbsIter !== newLastBreadcrumb && breadcrumbsIter.child !== null) {\n      breadcrumbsIter = breadcrumbsIter.child;\n    }\n\n    breadcrumbsIter.child = null;\n    this.#lastBreadcrumb = breadcrumbsIter;\n  }\n}\n"]}